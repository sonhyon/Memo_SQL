-- 직원 테이블 생성
CREATE TABLE employees (
    id INT PRIMARY KEY,
    name VARCHAR(50),
    salary INT,
    department_id INT
);

-- 부서 테이블 생성
CREATE TABLE departments (
    id INT PRIMARY KEY,
    name VARCHAR(50)
);

-- 부서 데이터 삽입
INSERT INTO departments (id, name) VALUES
(1, 'HR'),
(2, 'Engineering'),
(3, 'Sales');

-- 직원 데이터 삽입
INSERT INTO employees (id, name, salary, department_id) VALUES
(1, 'Alice', 5000, 1),
(2, 'Bob', 6000, 1),
(3, 'Charlie', 7000, 2),
(4, 'David', 8000, 2),
(5, 'Eve', 6500, 3),
(6, 'Frank', 6200, 3);
SELECT * FROM EMPLOYEES;
SELECT * FROM DEPARTMENTS;

#Q. 각 부서(department)별로 가장 급여(salary)를 많이 받는 직원(employee)의 이름과 급여를 조회하는 SQL문을 작성하세요.
SELECT D.ID AS DEPARTMENT_ID, E.NAME, D.NAME AS DEPARTMENT_NAME, E.SALARY
FROM EMPLOYEES E
JOIN DEPARTMENTS D ON E.DEPARTMENT_ID = D.ID
WHERE E.SALARY = (
    SELECT MAX(SALARY)
    FROM EMPLOYEES E2
    WHERE E2.DEPARTMENT_ID = E.DEPARTMENT_ID
);
